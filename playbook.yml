---

- hosts: localhost
  sudo: yes

  tasks:
  - name: Ensure NIP is installed.
    apt: 
      name=ntp
      state=installed

  - name: Ensure NTP is installed.
    service: 
      name=ntp
      state=started
      enabled=yes

  - name: Install Java
    apt:
      name=default-jre
      state=present

#  - name: Jenkins package
#    command: wget -q -O - https://pkg.jenkins.io/debian/jenkins-ci.org.key
#    command: apt-key add -
#    command: echo deb https://pkg.jenkins.io/debian-stable binary/
#    command: sudo tee /etc/apt/sources.list.d/jenkins.list
#    become: true

  - name: Update
    apt:
      update_cache: yes

  - name: Install Jenkins
    apt:
      name: jenkins
      state: present
      force: yes
    
  - name: Install apache2
    apt:
      name: apache2
      state: latest

  - name: Install ufw
    apt:
      name: ufw
      state: latest
      force: yes

#  - name: Opening port 8080 for Jenkins
#    command: ufw allow 8080
#    command: ufw allow OpenSSH
#    command: ufw enable
#    become: true
#    command: echo y
#    force: yes
#    install_recommends: no

  - name: Launching firewall
    ufw:
      state: enabled
      rule: allow
#      port: 8080
      name: OpenSSH

  - name: Enabling 8080
    ufw:
      rule: allow
      port: 8080
